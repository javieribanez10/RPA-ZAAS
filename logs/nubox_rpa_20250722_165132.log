2025-07-22 16:51:34 | INFO     | nubox_rpa.service | NuboxService inicializado con arquitectura modular
2025-07-22 16:51:34 | INFO     | nubox_rpa.authentication | Iniciando proceso de autenticaci√≥n
2025-07-22 16:51:34 | INFO     | nubox_rpa.browser_manager | Navegando a https://web.nubox.com/Login/Account/Login?ReturnUrl=%2FSistemaLogin
2025-07-22 16:51:38 | INFO     | nubox_rpa.authentication | Ingresando credenciales
2025-07-22 16:51:40 | INFO     | nubox_rpa.authentication | Bot√≥n de login encontrado con selector: input[value='Ingresar'][class*='nbx-form_btn_login']
2025-07-22 16:51:40 | INFO     | nubox_rpa.authentication | Haciendo clic en el bot√≥n Ingresar
2025-07-22 16:51:43 | INFO     | nubox_rpa.authentication | URL actual despu√©s del login: https://web.nubox.com/SistemaLogin/
2025-07-22 16:51:53 | INFO     | nubox_rpa.authentication | Login exitoso: URL cambi√≥
2025-07-22 16:51:53 | INFO     | nubox_rpa.navigation | Iniciando navegaci√≥n a reportes contables
2025-07-22 16:51:55 | INFO     | nubox_rpa.navigation | Navegando al m√≥dulo de Contabilidad
2025-07-22 16:51:55 | INFO     | nubox_rpa.navigation | Intentando selector: //td[contains(@class, 'jqx-cell') and contains(@class, 'jqx-grid-cell')]//span[contains(text(), 'Contabilidad')]
2025-07-22 16:51:55 | INFO     | nubox_rpa.navigation | Elementos encontrados: 1
2025-07-22 16:51:55 | INFO     | nubox_rpa.navigation | Elemento de Contabilidad encontrado y visible
2025-07-22 16:51:56 | INFO     | nubox_rpa.navigation | Clic exitoso en Contabilidad
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Reportes
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Buscando Reportes con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_MenuEnfocar') and text()='Reportes']
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Elementos de Reportes encontrados: 1
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Elemento de Reportes encontrado y visible
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Clic exitoso en Reportes
2025-07-22 16:51:58 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Libros Contables
2025-07-22 16:51:59 | INFO     | nubox_rpa.navigation | Buscando Libros Contables con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_SubMenuEnfocar') and contains(text(), 'Libros Contables')]
2025-07-22 16:51:59 | INFO     | nubox_rpa.navigation | Elementos de Libros Contables encontrados: 1
2025-07-22 16:51:59 | INFO     | nubox_rpa.navigation | Elemento de Libros Contables encontrado y visible
2025-07-22 16:52:00 | INFO     | nubox_rpa.navigation | Clic exitoso en Libros Contables
2025-07-22 16:52:00 | INFO     | nubox_rpa.navigation | Buscando el reporte Mayor
2025-07-22 16:52:01 | INFO     | nubox_rpa.navigation | Buscando Mayor con selector: //a[@onclick="NbxAnalyticsTrackMenu('Mayor')" and @href='conReportesLibroMayorGenerar.asp']
2025-07-22 16:52:01 | INFO     | nubox_rpa.navigation | Elementos de Mayor encontrados: 1
2025-07-22 16:52:01 | INFO     | nubox_rpa.navigation | Elemento de Mayor encontrado y visible
2025-07-22 16:52:01 | INFO     | nubox_rpa.navigation | Clic exitoso en Mayor
2025-07-22 16:52:01 | INFO     | nubox_rpa.navigation | Navegaci√≥n completada exitosamente
2025-07-22 16:52:01 | INFO     | nubox_rpa.streamlit | Extrayendo opciones de dropdowns de la p√°gina de Nubox
2025-07-22 16:52:01 | INFO     | nubox_rpa.ui_elements | Extrayendo opciones de dropdowns disponibles
2025-07-22 16:52:41 | INFO     | nubox_rpa.ui_elements | Encontrados 7 elementos select
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Dropdown 'Empresa': 19 opciones, seleccionado: '051,  VERSE CONSULTORES LTDA'
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Dropdown 'Tipo de Reporte': 4 opciones, seleccionado: 'ANALISIS POR CUENTA'
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Dropdown 'Formato de Salida': 2 opciones, seleccionado: 'PDF'
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Dropdown 'Cuenta Contable': 158 opciones, seleccionado: '1101-01 CUENTA CAJA'
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Dropdown 'Incluir Subcuentas': 2 opciones, seleccionado: 'NO'
2025-07-22 16:52:42 | INFO     | nubox_rpa.ui_elements | Extra√≠das opciones de 5 dropdowns
2025-07-22 16:52:42 | INFO     | nubox_rpa.streamlit | Opciones de dropdowns extra√≠das exitosamente: 5 dropdowns
2025-07-22 16:53:08 | INFO     | nubox_rpa.report_extractor | Iniciando extracci√≥n m√∫ltiple para 3 combinaciones (3 empresas √ó 1 cuentas)
2025-07-22 16:53:08 | INFO     | nubox_rpa.report_extractor | üè¢ Procesando empresa 1/3: 527,  PUNTO HUMANO SPA
2025-07-22 16:53:08 | INFO     | nubox_rpa.report_extractor | üí∞ Procesando combinaci√≥n 1/3: 527,  PUNTO HUMANO SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:53:08 | INFO     | nubox_rpa.report_extractor | Configurando par√°metros para: 527,  PUNTO HUMANO SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:53:08 | INFO     | nubox_rpa.parameter_config | Iniciando configuraci√≥n program√°tica de par√°metros
2025-07-22 16:53:18 | INFO     | nubox_rpa.parameter_config | iframes encontrados en la p√°gina: 0
2025-07-22 16:53:18 | INFO     | nubox_rpa.parameter_config | Configurando dropdowns antes que las fechas para evitar reversi√≥n
2025-07-22 16:53:18 | INFO     | nubox_rpa.parameter_config | Configurando selecciones de dropdowns
2025-07-22 16:53:18 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Empresa'
2025-07-22 16:53:30 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Empresa' configurado exitosamente
2025-07-22 16:53:30 | INFO     | nubox_rpa.parameter_config | Dropdown 'Empresa' configurado: 527,  PUNTO HUMANO SPA
2025-07-22 16:53:30 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Tipo de Reporte'
2025-07-22 16:53:30 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Tipo de Reporte' configurado exitosamente
2025-07-22 16:53:30 | INFO     | nubox_rpa.parameter_config | Dropdown 'Tipo de Reporte' configurado: ANALISIS POR CUENTA
2025-07-22 16:53:31 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Formato de Salida'
2025-07-22 16:53:31 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Formato de Salida' configurado exitosamente
2025-07-22 16:53:31 | INFO     | nubox_rpa.parameter_config | Dropdown 'Formato de Salida' configurado: EXCEL
2025-07-22 16:53:32 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Cuenta Contable'
2025-07-22 16:53:43 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Cuenta Contable' configurado con m√©todo alternativo
2025-07-22 16:53:43 | INFO     | nubox_rpa.parameter_config | Dropdown 'Cuenta Contable' configurado: 5101-01 VENTAS POR SERVICIO
2025-07-22 16:53:44 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Incluir Subcuentas'
2025-07-22 16:53:45 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Incluir Subcuentas' configurado exitosamente
2025-07-22 16:53:45 | INFO     | nubox_rpa.parameter_config | Dropdown 'Incluir Subcuentas' configurado: NO
2025-07-22 16:53:45 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde' al final: 01/01/2025
2025-07-22 16:53:45 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde': 01/01/2025
2025-07-22 16:53:46 | INFO     | nubox_rpa.parameter_config | Fecha 'Desde' configurada: 01/01/2025
2025-07-22 16:53:46 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta' al final: 01/02/2025
2025-07-22 16:53:46 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta': 01/02/2025
2025-07-22 16:53:47 | INFO     | nubox_rpa.parameter_config | Fecha 'Hasta' configurada: 01/02/2025
2025-07-22 16:53:47 | INFO     | nubox_rpa.parameter_config | Buscando bot√≥n para generar el reporte
2025-07-22 16:53:47 | INFO     | nubox_rpa.parameter_config | Haciendo clic en el bot√≥n Aceptar para generar el reporte
2025-07-22 16:53:49 | INFO     | nubox_rpa.parameter_config | Clic con JavaScript en bot√≥n Aceptar exitoso
2025-07-22 16:53:49 | INFO     | nubox_rpa.parameter_config | Esperando a que se genere el reporte...
2025-07-22 16:53:57 | INFO     | nubox_rpa.report_extractor | Extrayendo datos para: 527,  PUNTO HUMANO SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:53:57 | INFO     | nubox_rpa.report_extractor | Iniciando extracci√≥n de reporte
2025-07-22 16:54:37 | INFO     | nubox_rpa.report_extractor | Esperando a que se complete la descarga...
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | Archivo descargado encontrado: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025.xls
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | Validando archivo: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025.xls (tama√±o: 2077 bytes)
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | Primeros 100 caracteres del archivo: <html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><!--[if gte mso 9]><xml><x:ExcelWorkboo
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | ‚úÖ DETECTADO: Archivo HTML-Excel v√°lido de Nubox
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa. Preparando para siguiente cuenta...
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | üìã Detectado formato HTML-Excel de Microsoft Office (Nubox)
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | üìã Iniciando extracci√≥n de datos HTML-Excel...
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | üìã Informaci√≥n de empresa extra√≠da: {'Nombre': 'PUNTO HUMANO SPA', 'Rut': '76.558.527-9', 'Representante Legal': 'PAULO ALEJANDRO SUBIABRE CEPEDA', 'Giro Comercial': 'VENTAS AL POR MENOR A CAMBIO DE'}
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | üìã Encabezados encontrados: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | üìä Se extrajeron 2 filas de datos
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | ‚úÖ Datos contables limpiados: 2 filas resultantes
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | ‚úÖ DataFrame HTML-Excel creado exitosamente: 2 filas, 7 columnas
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | Columnas: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa para: 527,  PUNTO HUMANO SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:54:48 | INFO     | nubox_rpa.report_extractor | Navegando al formulario Mayor para siguiente combinaci√≥n (2/3)
2025-07-22 16:54:48 | INFO     | nubox_rpa.navigation | Navegando intencionalmente a SistemaLogin para empezar proceso limpio
2025-07-22 16:54:48 | INFO     | nubox_rpa.navigation | üîÑ Navegando a https://web.nubox.com/SistemaLogin
2025-07-22 16:54:51 | INFO     | nubox_rpa.navigation | URL actual despu√©s de navegaci√≥n: https://web.nubox.com/SistemaLogin
2025-07-22 16:54:51 | INFO     | nubox_rpa.navigation | üöÄ Iniciando navegaci√≥n completa desde SistemaLogin para siguiente cuenta
2025-07-22 16:54:51 | INFO     | nubox_rpa.navigation | Ejecutando proceso completo de navegaci√≥n desde SistemaLogin
2025-07-22 16:54:53 | INFO     | nubox_rpa.navigation | Navegando al m√≥dulo de Contabilidad
2025-07-22 16:54:53 | INFO     | nubox_rpa.navigation | Intentando selector: //td[contains(@class, 'jqx-cell') and contains(@class, 'jqx-grid-cell')]//span[contains(text(), 'Contabilidad')]
2025-07-22 16:54:53 | INFO     | nubox_rpa.navigation | Elementos encontrados: 1
2025-07-22 16:54:53 | INFO     | nubox_rpa.navigation | Elemento de Contabilidad encontrado y visible
2025-07-22 16:54:54 | INFO     | nubox_rpa.navigation | Clic exitoso en Contabilidad
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Reportes
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Buscando Reportes con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_MenuEnfocar') and text()='Reportes']
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Elementos de Reportes encontrados: 1
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Elemento de Reportes encontrado y visible
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Clic exitoso en Reportes
2025-07-22 16:54:56 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Libros Contables
2025-07-22 16:54:57 | INFO     | nubox_rpa.navigation | Buscando Libros Contables con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_SubMenuEnfocar') and contains(text(), 'Libros Contables')]
2025-07-22 16:54:57 | INFO     | nubox_rpa.navigation | Elementos de Libros Contables encontrados: 1
2025-07-22 16:54:57 | INFO     | nubox_rpa.navigation | Elemento de Libros Contables encontrado y visible
2025-07-22 16:54:58 | INFO     | nubox_rpa.navigation | Clic exitoso en Libros Contables
2025-07-22 16:54:58 | INFO     | nubox_rpa.navigation | Buscando el reporte Mayor
2025-07-22 16:54:59 | INFO     | nubox_rpa.navigation | Buscando Mayor con selector: //a[@onclick="NbxAnalyticsTrackMenu('Mayor')" and @href='conReportesLibroMayorGenerar.asp']
2025-07-22 16:54:59 | INFO     | nubox_rpa.navigation | Elementos de Mayor encontrados: 1
2025-07-22 16:54:59 | INFO     | nubox_rpa.navigation | Elemento de Mayor encontrado y visible
2025-07-22 16:54:59 | INFO     | nubox_rpa.navigation | Clic exitoso en Mayor
2025-07-22 16:54:59 | INFO     | nubox_rpa.navigation | ‚úÖ Navegaci√≥n completa desde SistemaLogin exitosa
2025-07-22 16:54:59 | INFO     | nubox_rpa.report_extractor | üè¢ Procesando empresa 2/3: 903,  COMERCIALIZADORA INSERT S.A.
2025-07-22 16:54:59 | INFO     | nubox_rpa.report_extractor | üí∞ Procesando combinaci√≥n 2/3: 903,  COMERCIALIZADORA INSERT S.A. - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:54:59 | INFO     | nubox_rpa.report_extractor | Configurando par√°metros para: 903,  COMERCIALIZADORA INSERT S.A. - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:54:59 | INFO     | nubox_rpa.parameter_config | Iniciando configuraci√≥n program√°tica de par√°metros
2025-07-22 16:54:59 | INFO     | nubox_rpa.parameter_config | iframes encontrados en la p√°gina: 11
2025-07-22 16:54:59 | INFO     | nubox_rpa.parameter_config | iframe 0: name='iframe_0', src='sin_src'
2025-07-22 16:55:10 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 0: 0
2025-07-22 16:55:10 | INFO     | nubox_rpa.parameter_config | iframe 1: name='iframe_1', src='sin_src'
2025-07-22 16:55:20 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 1: 0
2025-07-22 16:55:20 | INFO     | nubox_rpa.parameter_config | iframe 2: name='iframe_2', src='sin_src'
2025-07-22 16:55:30 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 2: 0
2025-07-22 16:55:30 | INFO     | nubox_rpa.parameter_config | iframe 3: name='iframe_3', src='sin_src'
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 3: 0
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | iframe 4: name='Contenido', src='https://app.nubox.com/ServicontPlus/Asp/conPortadaContenido.asp'
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 4: 14
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Usando iframe 4 que contiene 14 inputs
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Configurando dropdowns antes que las fechas para evitar reversi√≥n
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Configurando selecciones de dropdowns
2025-07-22 16:55:40 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Empresa'
2025-07-22 16:55:51 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Empresa' configurado exitosamente
2025-07-22 16:55:51 | INFO     | nubox_rpa.parameter_config | Dropdown 'Empresa' configurado: 903,  COMERCIALIZADORA INSERT S.A.
2025-07-22 16:55:51 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Tipo de Reporte'
2025-07-22 16:55:51 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Tipo de Reporte' configurado exitosamente
2025-07-22 16:55:51 | INFO     | nubox_rpa.parameter_config | Dropdown 'Tipo de Reporte' configurado: ANALISIS POR CUENTA
2025-07-22 16:55:52 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Formato de Salida'
2025-07-22 16:55:52 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Formato de Salida' configurado exitosamente
2025-07-22 16:55:52 | INFO     | nubox_rpa.parameter_config | Dropdown 'Formato de Salida' configurado: EXCEL
2025-07-22 16:55:53 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Cuenta Contable'
2025-07-22 16:56:04 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Cuenta Contable' configurado con m√©todo alternativo
2025-07-22 16:56:04 | INFO     | nubox_rpa.parameter_config | Dropdown 'Cuenta Contable' configurado: 5101-01 VENTAS POR SERVICIO
2025-07-22 16:56:05 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Incluir Subcuentas'
2025-07-22 16:56:06 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Incluir Subcuentas' configurado exitosamente
2025-07-22 16:56:06 | INFO     | nubox_rpa.parameter_config | Dropdown 'Incluir Subcuentas' configurado: NO
2025-07-22 16:56:06 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde' al final: 01/01/2025
2025-07-22 16:56:06 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde': 01/01/2025
2025-07-22 16:56:07 | INFO     | nubox_rpa.parameter_config | Fecha 'Desde' configurada: 01/01/2025
2025-07-22 16:56:07 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta' al final: 01/02/2025
2025-07-22 16:56:07 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta': 01/02/2025
2025-07-22 16:56:08 | INFO     | nubox_rpa.parameter_config | Fecha 'Hasta' configurada: 01/02/2025
2025-07-22 16:56:08 | INFO     | nubox_rpa.parameter_config | Buscando bot√≥n para generar el reporte
2025-07-22 16:56:08 | INFO     | nubox_rpa.parameter_config | Haciendo clic en el bot√≥n Aceptar para generar el reporte
2025-07-22 16:56:10 | INFO     | nubox_rpa.parameter_config | Clic con JavaScript en bot√≥n Aceptar exitoso
2025-07-22 16:56:10 | INFO     | nubox_rpa.parameter_config | Esperando a que se genere el reporte...
2025-07-22 16:56:18 | INFO     | nubox_rpa.report_extractor | Extrayendo datos para: 903,  COMERCIALIZADORA INSERT S.A. - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:56:18 | INFO     | nubox_rpa.report_extractor | Iniciando extracci√≥n de reporte
2025-07-22 16:56:59 | INFO     | nubox_rpa.report_extractor | Esperando a que se complete la descarga...
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | Archivo descargado encontrado: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025 (1).xls
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | Validando archivo: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025 (1).xls (tama√±o: 2283 bytes)
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | Primeros 100 caracteres del archivo: <html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><!--[if gte mso 9]><xml><x:ExcelWorkboo
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | ‚úÖ DETECTADO: Archivo HTML-Excel v√°lido de Nubox
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa. Preparando para siguiente cuenta...
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | üìã Detectado formato HTML-Excel de Microsoft Office (Nubox)
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | üìã Iniciando extracci√≥n de datos HTML-Excel...
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | üìã Informaci√≥n de empresa extra√≠da: {'Nombre': 'COMERCIALIZADORA INSERT S.A.', 'Rut': '76.129.903-4', 'Representante Legal': 'PAULO ALEJANDRO SUBIABRE CEPEDA', 'Giro Comercial': 'VENTAS AL POR MENOR A CAMBIO DE'}
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | üìã Encabezados encontrados: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | üìä Se extrajeron 3 filas de datos
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | ‚úÖ Datos contables limpiados: 3 filas resultantes
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | ‚úÖ DataFrame HTML-Excel creado exitosamente: 3 filas, 7 columnas
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | Columnas: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa para: 903,  COMERCIALIZADORA INSERT S.A. - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:57:09 | INFO     | nubox_rpa.report_extractor | Navegando al formulario Mayor para siguiente combinaci√≥n (3/3)
2025-07-22 16:57:09 | INFO     | nubox_rpa.navigation | Navegando intencionalmente a SistemaLogin para empezar proceso limpio
2025-07-22 16:57:09 | INFO     | nubox_rpa.navigation | üîÑ Navegando a https://web.nubox.com/SistemaLogin
2025-07-22 16:57:12 | INFO     | nubox_rpa.navigation | URL actual despu√©s de navegaci√≥n: https://web.nubox.com/SistemaLogin
2025-07-22 16:57:12 | INFO     | nubox_rpa.navigation | üöÄ Iniciando navegaci√≥n completa desde SistemaLogin para siguiente cuenta
2025-07-22 16:57:12 | INFO     | nubox_rpa.navigation | Ejecutando proceso completo de navegaci√≥n desde SistemaLogin
2025-07-22 16:57:14 | INFO     | nubox_rpa.navigation | Navegando al m√≥dulo de Contabilidad
2025-07-22 16:57:14 | INFO     | nubox_rpa.navigation | Intentando selector: //td[contains(@class, 'jqx-cell') and contains(@class, 'jqx-grid-cell')]//span[contains(text(), 'Contabilidad')]
2025-07-22 16:57:14 | INFO     | nubox_rpa.navigation | Elementos encontrados: 1
2025-07-22 16:57:14 | INFO     | nubox_rpa.navigation | Elemento de Contabilidad encontrado y visible
2025-07-22 16:57:15 | INFO     | nubox_rpa.navigation | Clic exitoso en Contabilidad
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Reportes
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Buscando Reportes con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_MenuEnfocar') and text()='Reportes']
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Elementos de Reportes encontrados: 1
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Elemento de Reportes encontrado y visible
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Clic exitoso en Reportes
2025-07-22 16:57:17 | INFO     | nubox_rpa.navigation | Buscando el men√∫ de Libros Contables
2025-07-22 16:57:18 | INFO     | nubox_rpa.navigation | Buscando Libros Contables con selector: //a[@tabindex='-1' and contains(@onfocus, 'p_SubMenuEnfocar') and contains(text(), 'Libros Contables')]
2025-07-22 16:57:18 | INFO     | nubox_rpa.navigation | Elementos de Libros Contables encontrados: 1
2025-07-22 16:57:18 | INFO     | nubox_rpa.navigation | Elemento de Libros Contables encontrado y visible
2025-07-22 16:57:19 | INFO     | nubox_rpa.navigation | Clic exitoso en Libros Contables
2025-07-22 16:57:19 | INFO     | nubox_rpa.navigation | Buscando el reporte Mayor
2025-07-22 16:57:20 | INFO     | nubox_rpa.navigation | Buscando Mayor con selector: //a[@onclick="NbxAnalyticsTrackMenu('Mayor')" and @href='conReportesLibroMayorGenerar.asp']
2025-07-22 16:57:20 | INFO     | nubox_rpa.navigation | Elementos de Mayor encontrados: 1
2025-07-22 16:57:20 | INFO     | nubox_rpa.navigation | Elemento de Mayor encontrado y visible
2025-07-22 16:57:20 | INFO     | nubox_rpa.navigation | Clic exitoso en Mayor
2025-07-22 16:57:20 | INFO     | nubox_rpa.navigation | ‚úÖ Navegaci√≥n completa desde SistemaLogin exitosa
2025-07-22 16:57:20 | INFO     | nubox_rpa.report_extractor | üè¢ Procesando empresa 3/3: 906,  SELYT SPA
2025-07-22 16:57:20 | INFO     | nubox_rpa.report_extractor | üí∞ Procesando combinaci√≥n 3/3: 906,  SELYT SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:57:20 | INFO     | nubox_rpa.report_extractor | Configurando par√°metros para: 906,  SELYT SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:57:20 | INFO     | nubox_rpa.parameter_config | Iniciando configuraci√≥n program√°tica de par√°metros
2025-07-22 16:57:20 | INFO     | nubox_rpa.parameter_config | iframes encontrados en la p√°gina: 11
2025-07-22 16:57:20 | INFO     | nubox_rpa.parameter_config | iframe 0: name='iframe_0', src='sin_src'
2025-07-22 16:57:30 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 0: 0
2025-07-22 16:57:30 | INFO     | nubox_rpa.parameter_config | iframe 1: name='iframe_1', src='sin_src'
2025-07-22 16:57:40 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 1: 0
2025-07-22 16:57:41 | INFO     | nubox_rpa.parameter_config | iframe 2: name='iframe_2', src='sin_src'
2025-07-22 16:57:51 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 2: 0
2025-07-22 16:57:51 | INFO     | nubox_rpa.parameter_config | iframe 3: name='iframe_3', src='sin_src'
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 3: 0
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | iframe 4: name='Contenido', src='https://app.nubox.com/ServicontPlus/Asp/conPortadaContenido.asp'
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Inputs encontrados en iframe 4: 14
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Usando iframe 4 que contiene 14 inputs
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Configurando dropdowns antes que las fechas para evitar reversi√≥n
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Configurando selecciones de dropdowns
2025-07-22 16:58:01 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Empresa'
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Empresa' configurado exitosamente
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | Dropdown 'Empresa' configurado: 906,  SELYT SPA
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Tipo de Reporte'
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Tipo de Reporte' configurado exitosamente
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | Dropdown 'Tipo de Reporte' configurado: ANALISIS POR CUENTA
2025-07-22 16:58:12 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Formato de Salida'
2025-07-22 16:58:13 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Formato de Salida' configurado exitosamente
2025-07-22 16:58:13 | INFO     | nubox_rpa.parameter_config | Dropdown 'Formato de Salida' configurado: EXCEL
2025-07-22 16:58:14 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Cuenta Contable'
2025-07-22 16:58:25 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Cuenta Contable' configurado con m√©todo alternativo
2025-07-22 16:58:25 | INFO     | nubox_rpa.parameter_config | Dropdown 'Cuenta Contable' configurado: 5101-01 VENTAS POR SERVICIO
2025-07-22 16:58:26 | INFO     | nubox_rpa.parameter_config | Encontrado dropdown correcto: 'Incluir Subcuentas'
2025-07-22 16:58:27 | INFO     | nubox_rpa.parameter_config | ‚úÖ Dropdown 'Incluir Subcuentas' configurado exitosamente
2025-07-22 16:58:27 | INFO     | nubox_rpa.parameter_config | Dropdown 'Incluir Subcuentas' configurado: NO
2025-07-22 16:58:27 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde' al final: 01/01/2025
2025-07-22 16:58:27 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Desde': 01/01/2025
2025-07-22 16:58:28 | INFO     | nubox_rpa.parameter_config | Fecha 'Desde' configurada: 01/01/2025
2025-07-22 16:58:28 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta' al final: 01/02/2025
2025-07-22 16:58:28 | INFO     | nubox_rpa.parameter_config | Configurando fecha 'Hasta': 01/02/2025
2025-07-22 16:58:29 | INFO     | nubox_rpa.parameter_config | Fecha 'Hasta' configurada: 01/02/2025
2025-07-22 16:58:29 | INFO     | nubox_rpa.parameter_config | Buscando bot√≥n para generar el reporte
2025-07-22 16:58:29 | INFO     | nubox_rpa.parameter_config | Haciendo clic en el bot√≥n Aceptar para generar el reporte
2025-07-22 16:58:31 | INFO     | nubox_rpa.parameter_config | Clic con JavaScript en bot√≥n Aceptar exitoso
2025-07-22 16:58:31 | INFO     | nubox_rpa.parameter_config | Esperando a que se genere el reporte...
2025-07-22 16:58:39 | INFO     | nubox_rpa.report_extractor | Extrayendo datos para: 906,  SELYT SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:58:39 | INFO     | nubox_rpa.report_extractor | Iniciando extracci√≥n de reporte
2025-07-22 16:59:19 | INFO     | nubox_rpa.report_extractor | Esperando a que se complete la descarga...
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | Archivo descargado encontrado: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025 (2).xls
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | Validando archivo: /Users/javie/Downloads/LIBRO MAYOR DESDE 01_01_2025 A 01_02_2025 (2).xls (tama√±o: 2074 bytes)
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | Primeros 100 caracteres del archivo: <html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><!--[if gte mso 9]><xml><x:ExcelWorkboo
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | ‚úÖ DETECTADO: Archivo HTML-Excel v√°lido de Nubox
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa. Preparando para siguiente cuenta...
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üìã Detectado formato HTML-Excel de Microsoft Office (Nubox)
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üìã Iniciando extracci√≥n de datos HTML-Excel...
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üìã Informaci√≥n de empresa extra√≠da: {'Nombre': 'SELYT SPA', 'Rut': '77.081.534-7', 'Representante Legal': 'PAULO ALEJANDRO SUBIABRE CEPEDA', 'Giro Comercial': 'SERVICIOS TECNOLOGICOS'}
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üìã Encabezados encontrados: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üìä Se extrajeron 2 filas de datos
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | ‚úÖ Datos contables limpiados: 2 filas resultantes
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | ‚úÖ DataFrame HTML-Excel creado exitosamente: 2 filas, 7 columnas
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | Columnas: ['FECHA', 'COMPROBANTE', 'GLOSA', 'DEBE', 'HABER', 'SALDO', 'C.C.']
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | ‚úÖ Descarga exitosa para: 906,  SELYT SPA - 5101-01 VENTAS POR SERVICIO
2025-07-22 16:59:29 | INFO     | nubox_rpa.report_extractor | üéØ Extracci√≥n m√∫ltiple completada: 3 exitosas, 0 fallidas de 3 combinaciones
2025-07-22 16:59:31 | INFO     | nubox_rpa.mongodb | ‚úÖ Conectado exitosamente a MongoDB Atlas - Base de datos: nubox-data
2025-07-22 16:59:31 | INFO     | nubox_rpa.mongodb | ‚úÖ √çndices de Nubox creados exitosamente
2025-07-22 16:59:31 | INFO     | nubox_rpa.mongodb | ‚úÖ Reporte Nubox exportado exitosamente: 2 filas, ID: 687ffbb3b25b5dd98178bbc5
2025-07-22 16:59:32 | INFO     | nubox_rpa.mongodb | ‚úÖ √çndices de Nubox creados exitosamente
2025-07-22 16:59:32 | INFO     | nubox_rpa.mongodb | ‚úÖ Reporte Nubox exportado exitosamente: 3 filas, ID: 687ffbb3b25b5dd98178bbc6
2025-07-22 16:59:33 | INFO     | nubox_rpa.mongodb | ‚úÖ √çndices de Nubox creados exitosamente
2025-07-22 16:59:33 | INFO     | nubox_rpa.mongodb | ‚úÖ Reporte Nubox exportado exitosamente: 2 filas, ID: 687ffbb4b25b5dd98178bbc7
2025-07-22 16:59:33 | INFO     | nubox_rpa.mongodb | üîå Desconectado de MongoDB Atlas
